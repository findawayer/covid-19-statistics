{"version":3,"sources":["utils/cache-api.ts","config/optimizations.ts","utils/call-rate-limit.ts","utils/type-check.ts","hooks/useFetch.ts","config/data-table.ts","hooks/useTabularData.ts","components/svg/chevron-down.svg","components/styles/DataTable.ts","components/DataTable.tsx","utils/format.ts","components/styles/Loading.ts","components/Loading.tsx","components/styles/Search.ts","components/Search.tsx","components/styles/CovidStatistics.ts","components/CovidStatistics.tsx","config/api.ts","App.tsx","index.tsx"],"names":["canUseCache","window","readCache","key","request","a","caches","open","cache","match","writeCache","response","put","DEFAULT_FUNCTION_CALL_RATE_LIMIT","debounce","fn","lastTimeoutId","limit","args","context","this","clearTimeout","setTimeout","apply","isNumber","value","Number","isNaN","isFinite","initialResult","data","loading","error","fetchResultReducer","status","action","type","payload","Error","DEFAULT_SORT_DIRECTION","useTabularData","rowData","options","useState","overrides","filterKey","filterKeyword","sortKey","sortDirection","initializeOptions","dataOptions","setDataOptions","processedData","useMemo","processed","reverse","sort","z","aValue","zValue","compareNumericData","String","localeCompare","compareNonNumericData","sortData","pattern","RegExp","matchesPattern","test","filter","item","filterData","handleColumnClick","event","preventDefault","previousOptions","direction","handleKeywordChange","target","StyledTable","StyledCell","StyledHeadCell","withComponent","StyledSortIcon","isActive","ChevronDown","isAscending","DataTableRow","columns","map","toLocaleString","DataTable","idKey","data-testid","alias","onClick","undefined","StyledLoading","Loading","size","aria-label","width","height","viewBox","xmlns","stroke","fill","fillRule","transform","strokeWidth","strokeOpacity","cx","cy","r","d","attributeName","from","to","dur","repeatCount","memo","StyledSearch","Search","handleChange","placeholder","onChange","StyledCovidStatHeader","StyledCovidStatTitle","StyledCovidStatBody","StyledCovidStatScroll","CovidStatTable","uri","cacheKey","cacheMaxAge","useReducer","dispatch","cacheRef","useRef","timestamp","useEffect","hasCache","current","cacheIsValid","Date","now","Request","cachedResponse","fetch","ok","clone","json","getData","useFetch","message","App","CovidStatistics","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7eddc80c.chunk.js","sourcesContent":["function canUseCache(): boolean {\r\n  return 'caches' in window;\r\n}\r\n\r\nexport async function readCache(\r\n  key: string,\r\n  request: Request,\r\n): Promise<Response | undefined | null> {\r\n  if (!canUseCache()) return null;\r\n  const cache = await window.caches.open(key);\r\n  return cache.match(request);\r\n}\r\n\r\nexport async function writeCache(\r\n  key: string,\r\n  request: Request,\r\n  response: Response,\r\n): Promise<boolean> {\r\n  if (!canUseCache()) return false;\r\n  const cache = await window.caches.open(key);\r\n  cache.put(request, response);\r\n  return true;\r\n}\r\n","/** Function call: default delay for throttle and debounce. (in milliseconds) */\r\nexport const DEFAULT_FUNCTION_CALL_RATE_LIMIT = 300;\r\n","import { DEFAULT_FUNCTION_CALL_RATE_LIMIT } from '../config/optimizations';\r\n\r\nexport function debounce(\r\n  fn: (...args: any[]) => void,\r\n  limit = DEFAULT_FUNCTION_CALL_RATE_LIMIT,\r\n) {\r\n  let lastTimeoutId: number;\r\n\r\n  return function debouncedFn(this: unknown, ...args: any[]) {\r\n    const context = this;\r\n    window.clearTimeout(lastTimeoutId);\r\n    lastTimeoutId = window.setTimeout(() => {\r\n      fn.apply(context, args);\r\n    }, limit);\r\n  };\r\n}\r\n\r\nexport function throttle(\r\n  fn: (...args: any[]) => void,\r\n  limit = DEFAULT_FUNCTION_CALL_RATE_LIMIT,\r\n) {\r\n  let lastCall: number;\r\n  let lastTimeoutId: number;\r\n\r\n  return function throttledFn(this: unknown, ...args: any[]) {\r\n    const context = this;\r\n    if (!lastCall) {\r\n      fn.apply(context, args);\r\n      lastCall = Date.now();\r\n    } else {\r\n      const elapsed = Date.now() - lastCall;\r\n      window.clearTimeout(lastTimeoutId);\r\n      lastTimeoutId = window.setTimeout(function call() {\r\n        if (elapsed >= limit) {\r\n          fn.apply(context, args);\r\n          lastCall = Date.now();\r\n        }\r\n      }, limit - elapsed);\r\n    }\r\n  };\r\n}\r\n","export function isNumber(value: unknown): value is number {\r\n  // Exclude NaN and Infinity, -Infinity from numeric values.\r\n  return (\r\n    typeof value === 'number' && !Number.isNaN(value) && Number.isFinite(value)\r\n  );\r\n}\r\n","import { useEffect, useReducer, useRef } from 'react';\r\n\r\nimport { readCache, writeCache } from '../utils';\r\n\r\n/** Type of data that can be fetched from a JSON response. */\r\ntype JsonValue = string | number | boolean | null;\r\ntype JsonObject = Record<string | number, JsonValue>;\r\ntype JsonArrayOfObject = JsonObject[];\r\n\r\n/** Shallow schema of any JSON data. */\r\ntype JsonData = JsonObject | JsonArrayOfObject;\r\n\r\n/** Return value of `useFetch` hook. */\r\ntype FetchResult = {\r\n  data: JsonData | null;\r\n  loading: boolean;\r\n  error: Error | null;\r\n};\r\n\r\n/** Default return value of `useFetch` hook. */\r\nconst initialResult: FetchResult = {\r\n  data: null,\r\n  loading: true,\r\n  error: null,\r\n};\r\n\r\n/** Action for fetchResultReducer */\r\ntype Action =\r\n  | { type: 'setError'; payload: Error }\r\n  | { type: 'setData'; payload: JsonData };\r\n\r\n/** Update `fetchResult` object based on the action type. */\r\nconst fetchResultReducer = (\r\n  status: FetchResult,\r\n  action: Action,\r\n): FetchResult => {\r\n  switch (action.type) {\r\n    case 'setError':\r\n      return { ...status, loading: false, error: action.payload };\r\n\r\n    case 'setData':\r\n      return { ...status, loading: false, data: action.payload };\r\n\r\n    default:\r\n      throw new Error('Unhandled action type.');\r\n  }\r\n};\r\n\r\ntype UseFetchOptions = {\r\n  cacheKey?: string;\r\n  cacheMaxAge?: number;\r\n};\r\n\r\n/**\r\n * Hook for\r\n * 1. Declarative data fetch.\r\n * 2. Use Cache API: https://developer.mozilla.org/en-US/docs/Web/API/Cache\r\n *\r\n * @todo Correct type capturing :)\r\n */\r\nexport const useFetch = <T extends JsonData>(\r\n  uri: string,\r\n  { cacheKey, cacheMaxAge }: UseFetchOptions = {},\r\n) => {\r\n  const [{ data, loading, error }, dispatch] = useReducer(\r\n    fetchResultReducer,\r\n    initialResult,\r\n  );\r\n  const cacheRef = useRef({\r\n    key: cacheKey,\r\n    timestamp: 0,\r\n  });\r\n\r\n  // Fetch data.\r\n  useEffect(() => {\r\n    async function getData(): Promise<void> {\r\n      // Validate cache.\r\n      const hasCache = cacheRef.current.key && cacheMaxAge;\r\n      const cacheIsValid =\r\n        Date.now() - cacheRef.current.timestamp < (cacheMaxAge || 0);\r\n      // Try to find previously cached response.\r\n      const request = new Request(uri);\r\n      const cachedResponse =\r\n        hasCache && cacheIsValid\r\n          ? await readCache(cacheRef.current.key!, request)\r\n          : null;\r\n      // Otherwise, fetch new data.\r\n      const response = cachedResponse ?? (await fetch(uri));\r\n      // Something went wrong x(\r\n      if (!response.ok) {\r\n        const error = new Error(`Request failed: ${uri}`);\r\n        dispatch({ type: 'setError', payload: error });\r\n        return;\r\n      }\r\n      // Cache the data.\r\n      if (hasCache && !cacheIsValid) {\r\n        writeCache(cacheRef.current.key!, request, response.clone());\r\n      }\r\n      // Set the retrieved data.\r\n      const data = await response.json();\r\n      dispatch({ type: 'setData', payload: data });\r\n    }\r\n\r\n    getData();\r\n  }, [cacheMaxAge, dispatch, uri]);\r\n\r\n  return { data: data as T | null, loading, error };\r\n};\r\n","/** Data table: default sort direction. */\r\nexport const DEFAULT_SORT_DIRECTION = 'descending' as const;\r\n","import type { ChangeEvent, MouseEvent, TouchEvent } from 'react';\r\nimport { useMemo, useState } from 'react';\r\n\r\nimport { DEFAULT_SORT_DIRECTION } from '../config/data-table';\r\nimport { isNumber } from '../utils';\r\n\r\ntype SortDirection = 'ascending' | 'descending';\r\n\r\n/** Core options for the tabular data. */\r\ntype DataOptions = {\r\n  /** Name of column to use for data filtering. */\r\n  filterKey: string | null;\r\n  /** Search keyword to filter data with. */\r\n  filterKeyword: string | null;\r\n  /** Name of column to use for data sorting. */\r\n  sortKey: string | null;\r\n  /** Direction of data sorting. */\r\n  sortDirection: SortDirection;\r\n};\r\n\r\n/** Create initial data options. */\r\nconst initializeOptions = (overrides: Partial<DataOptions> = {}) => ({\r\n  filterKey: null,\r\n  filterKeyword: null,\r\n  sortKey: null,\r\n  sortDirection: DEFAULT_SORT_DIRECTION,\r\n  ...overrides,\r\n});\r\n\r\n/** Tabular data processor hook. */\r\nexport const useTabularData = (\r\n  rowData: Record<string, TODO>[] | null,\r\n  options?: Partial<DataOptions>,\r\n) => {\r\n  const [dataOptions, setDataOptions] = useState<DataOptions>(\r\n    initializeOptions(options),\r\n  );\r\n\r\n  /** Processed table data (sorted, filtered and memoized.) */\r\n  const processedData = useMemo(() => {\r\n    // Data not yet provided because of network latency.\r\n    if (!rowData) return null;\r\n    // Create a copy of the raw data. // TODO: deep copy? we need it?\r\n    let processed = [...rowData];\r\n    // Filter data.\r\n    // Faster process should be done first, as it reduces the data to process ahead of time.\r\n    processed = filterData(processed, dataOptions);\r\n    // Sort data.\r\n    processed = sortData(processed, dataOptions);\r\n    // Return the processed data.\r\n    return processed;\r\n  }, [dataOptions, rowData]);\r\n\r\n  /** Sort data on clicking on column headings.  */\r\n  const handleColumnClick = (sortKey: string) => (\r\n    event: MouseEvent | TouchEvent,\r\n  ) => {\r\n    // Just in case the heading is an interactive element, e.g. <a />\r\n    event.preventDefault();\r\n    // Update options.\r\n    setDataOptions(previousOptions => {\r\n      // Same sort key -> toggle sort direction\r\n      if (previousOptions.sortKey === sortKey) {\r\n        return {\r\n          ...previousOptions,\r\n          sortDirection: flipDirection(previousOptions.sortDirection),\r\n        };\r\n      }\r\n      // Different sort key ->\r\n      return {\r\n        ...previousOptions,\r\n        sortKey,\r\n        sortDirection: DEFAULT_SORT_DIRECTION,\r\n      };\r\n    });\r\n  };\r\n\r\n  /** Filter data on clicking on column headings. */\r\n  const handleKeywordChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setDataOptions(previousOptions => ({\r\n      ...previousOptions,\r\n      filterKeyword: event.target.value || null,\r\n    }));\r\n  };\r\n\r\n  return {\r\n    processedData,\r\n    dataOptions,\r\n    handleColumnClick,\r\n    handleKeywordChange,\r\n  };\r\n};\r\n\r\n/** Invert direction of sorting. */\r\nfunction flipDirection(direction: SortDirection): SortDirection {\r\n  return direction === 'ascending' ? 'descending' : 'ascending';\r\n}\r\n\r\n/** Filter data based on `filterKey` and `filterKeyword` option provided. */\r\nfunction filterData<T extends Record<string, unknown>>(\r\n  data: T[],\r\n  options: Pick<DataOptions, 'filterKey' | 'filterKeyword'>,\r\n): T[] {\r\n  const { filterKey, filterKeyword } = options;\r\n  // Return the data as-is, if no filtering option is set.\r\n  if (!filterKey || !filterKeyword) return data;\r\n  // Filter items in data, that matches the search keyword. (case-insensitive)\r\n  const pattern = new RegExp(filterKeyword, 'i');\r\n  const matchesPattern = (value: unknown) => pattern.test(String(value));\r\n  return data.filter(item => matchesPattern(item[filterKey]));\r\n}\r\n\r\n/** Sort data based on `sortKey` and `sortDirection` option provided. */\r\nfunction sortData<T extends Record<string, unknown>>(\r\n  data: T[],\r\n  options: Pick<DataOptions, 'sortKey' | 'sortDirection'>,\r\n): T[] {\r\n  const { sortKey, sortDirection } = options;\r\n  // Return the data as-is, if no sort option is set.\r\n  if (!sortKey) return data;\r\n\r\n  const reverse = sortDirection === 'descending';\r\n\r\n  return data.sort((a, z) => {\r\n    const aValue = a[sortKey];\r\n    const zValue = z[sortKey];\r\n\r\n    return isNumber(aValue) && isNumber(zValue)\r\n      ? compareNumericData(aValue, zValue, reverse)\r\n      : compareNonNumericData(aValue, zValue, reverse);\r\n  });\r\n}\r\n\r\n/** Sort comparator for numeric data. */\r\nfunction compareNumericData(a: number, z: number, reverse = false) {\r\n  return reverse ? z - a : a - z;\r\n}\r\n\r\n/** Sort comparator for non-numeric data. */\r\nfunction compareNonNumericData(a: unknown, z: unknown, reverse = false) {\r\n  return reverse\r\n    ? String(z).localeCompare(String(a))\r\n    : String(a).localeCompare(String(z));\r\n}\r\n","export default __webpack_public_path__ + \"static/media/chevron-down.24c82cb7.svg\";","import styled from '@emotion/styled';\r\n\r\nimport ChevronDown from '../svg/chevron-down.svg';\r\n\r\nexport const StyledTable = styled.table`\r\n  position: relative;\r\n  width: 100%;\r\n  border-collapse: separate;\r\n  border-spacing: 0;\r\n`;\r\n\r\nexport const StyledCell = styled.td`\r\n  padding: 0.75em 1em;\r\n  border: double #ccc;\r\n  border-width: 0 1px 1px 0;\r\n  text-align: left;\r\n\r\n  &:last-child {\r\n    border-right-width: 0;\r\n  }\r\n`;\r\n\r\n// Some browsers only support sticky on `th`, not on `thead`.\r\nexport const StyledHeadCell = styled(StyledCell)`\r\n  position: sticky;\r\n  top: 0;\r\n  padding-top: 1em;\r\n  padding-bottom: 1em;\r\n  border-top-width: 1px;\r\n  background-color: #eee;\r\n  font-weight: 700;\r\n  cursor: pointer;\r\n`.withComponent('th');\r\n\r\ntype StyledSortIconProps = {\r\n  isActive: boolean;\r\n  isAscending: boolean;\r\n};\r\n\r\nexport const StyledSortIcon = styled.i<StyledSortIconProps>`\r\n  width: 1rem;\r\n  height: 1rem;\r\n  float: right;\r\n  visibility: ${({ isActive }) => (isActive ? 'visible' : 'hidden')};\r\n  background: url(${ChevronDown}) no-repeat center / 100% auto;\r\n  ${({ isAscending }) => isAscending && `transform: rotate(-0.5turn);`}\r\n`;\r\n","import type { FunctionComponent, MouseEvent, TouchEvent } from 'react';\r\nimport React from 'react';\r\n\r\nimport { formatValue } from '../utils';\r\nimport {\r\n  StyledCell,\r\n  StyledHeadCell,\r\n  StyledSortIcon,\r\n  StyledTable,\r\n} from './styles/DataTable';\r\n\r\ntype ColumnDefinition = {\r\n  key: string;\r\n  alias: string;\r\n};\r\n\r\n// Row --------------------\r\n\r\ninterface DataTableRowProps {\r\n  item: TODO;\r\n  columns: readonly ColumnDefinition[];\r\n}\r\n\r\nconst DataTableRow: FunctionComponent<DataTableRowProps> = ({\r\n  item,\r\n  columns,\r\n}) => {\r\n  return (\r\n    <tr>\r\n      {columns.map(({ key }) => (\r\n        <StyledCell key={key}>{formatValue(item[key])}</StyledCell>\r\n      ))}\r\n    </tr>\r\n  );\r\n};\r\n\r\n// Table --------------------\r\n\r\ninterface DataTableProps {\r\n  data: TODO[] | null;\r\n  columns: readonly ColumnDefinition[];\r\n  idKey: string;\r\n  sortKey?: string | null;\r\n  sortDirection?: 'ascending' | 'descending';\r\n  handleColumnClick?: (\r\n    sortKey: string,\r\n  ) => (event: MouseEvent | TouchEvent) => void;\r\n}\r\n\r\nconst DataTable: FunctionComponent<DataTableProps> = ({\r\n  data,\r\n  columns,\r\n  idKey,\r\n  sortKey,\r\n  sortDirection,\r\n  handleColumnClick,\r\n}) => {\r\n  return (\r\n    <StyledTable>\r\n      <thead data-testid=\"thead\">\r\n        <tr>\r\n          {columns.map(({ key, alias }) => (\r\n            <StyledHeadCell\r\n              key={key}\r\n              onClick={handleColumnClick ? handleColumnClick(key) : undefined}\r\n              data-testid={key}\r\n            >\r\n              {alias ?? key}\r\n              <StyledSortIcon\r\n                isActive={key === sortKey}\r\n                isAscending={sortDirection === 'ascending'}\r\n              />\r\n            </StyledHeadCell>\r\n          ))}\r\n        </tr>\r\n      </thead>\r\n      <tbody data-testid=\"tbody\">\r\n        {data &&\r\n          data.map(item => (\r\n            <DataTableRow key={item[idKey]} item={item} columns={columns} />\r\n          ))}\r\n      </tbody>\r\n    </StyledTable>\r\n  );\r\n};\r\n\r\nexport default DataTable;\r\n","import { isNumber } from './type-check';\r\n\r\nexport function formatValue(value: unknown): string {\r\n  if (isNumber(value)) {\r\n    return value.toLocaleString('kr');\r\n  }\r\n  return String(value);\r\n}\r\n","import styled from '@emotion/styled';\r\n\r\nexport const StyledLoading = styled.div`\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n`;\r\n","import type { FunctionComponent } from 'react';\r\nimport React, { memo } from 'react';\r\n\r\nimport { StyledLoading } from './styles/Loading';\r\n\r\ninterface LoadingProps {\r\n  size?: number;\r\n}\r\n\r\n/* SVG-loaders | 2014 Sam Herbert, MIT License | https://github.com/SamHerbert/SVG-Loaders */\r\nconst Loading: FunctionComponent<LoadingProps> = ({ size = 64 }) => {\r\n  return (\r\n    <StyledLoading aria-label=\"Loading\">\r\n      <svg\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 38 38\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        stroke=\"#3498DB\"\r\n      >\r\n        <g fill=\"none\" fillRule=\"evenodd\">\r\n          <g transform=\"translate(1 1)\" strokeWidth=\"2\">\r\n            <circle strokeOpacity=\".5\" cx=\"18\" cy=\"18\" r=\"18\" />\r\n            <path d=\"M36 18c0-9.94-8.06-18-18-18\">\r\n              <animateTransform\r\n                attributeName=\"transform\"\r\n                type=\"rotate\"\r\n                from=\"0 18 18\"\r\n                to=\"360 18 18\"\r\n                dur=\"1s\"\r\n                repeatCount=\"indefinite\"\r\n              />\r\n            </path>\r\n          </g>\r\n        </g>\r\n      </svg>\r\n    </StyledLoading>\r\n  );\r\n};\r\n\r\nexport default memo(Loading);\r\n","import styled from '@emotion/styled';\r\n\r\nexport const StyledSearch = styled.input`\r\n  display: block;\r\n  width: 15em;\r\n  padding: 0.75em 1em;\r\n  background: #fff;\r\n  border: 1px solid #ccc;\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\r\n  transition: width 0.1s;\r\n\r\n  &:focus {\r\n    width: 25em;\r\n    outline: 0;\r\n    border-color: #000;\r\n  }\r\n`;\r\n","import type { ChangeEvent, FunctionComponent } from 'react';\r\nimport React from 'react';\r\n\r\nimport { debounce } from '../utils/call-rate-limit';\r\nimport { StyledSearch } from './styles/Search';\r\n\r\ninterface SearchProps {\r\n  handleChange(event: ChangeEvent<HTMLInputElement>): void;\r\n}\r\n\r\nconst Search: FunctionComponent<SearchProps> = ({ handleChange }) => {\r\n  return (\r\n    <StyledSearch\r\n      type=\"search\"\r\n      placeholder=\"국가로 검색\"\r\n      onChange={debounce(handleChange)}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Search;\r\n","import styled from '@emotion/styled';\r\n\r\nexport const StyledCovidStatHeader = styled.div`\r\n  height: 4rem;\r\n  margin-bottom: 1rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n`;\r\n\r\nexport const StyledCovidStatTitle = styled.h1`\r\n  margin: 0;\r\n  flex: 1 1 auto;\r\n  font-size: 2rem;\r\n  font-weight: 700;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n`;\r\n\r\nexport const StyledCovidStatBody = styled.div`\r\n  height: calc(100vh - 8rem);\r\n  overflow: auto;\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\r\n`;\r\n\r\nexport const StyledCovidStatScroll = styled.div`\r\n  position: relative;\r\n  min-width: 50em;\r\n  height: 100%;\r\n`;\r\n","import type { FunctionComponent } from 'react';\r\nimport React from 'react';\r\n\r\nimport { API_COVID_19_ALL_COUNTRY } from '../config/api';\r\nimport { useFetch } from '../hooks/useFetch';\r\nimport { useTabularData } from '../hooks/useTabularData';\r\nimport type { CovidCountryStat } from '../models/covid-19-api';\r\nimport DataTable from './DataTable';\r\nimport Loading from './Loading';\r\nimport Search from './Search';\r\nimport {\r\n  StyledCovidStatBody,\r\n  StyledCovidStatHeader,\r\n  StyledCovidStatScroll,\r\n  StyledCovidStatTitle,\r\n} from './styles/CovidStatistics';\r\n\r\nconst columns = [\r\n  { key: 'country', alias: '국가' },\r\n  { key: 'confirmed', alias: '확진자' },\r\n  { key: 'recovered', alias: '완치자' },\r\n  { key: 'critical', alias: '치명적' },\r\n  { key: 'deaths', alias: '사망자' },\r\n];\r\n\r\nconst CovidStatTable: FunctionComponent = () => {\r\n  const { data, loading, error } = useFetch<CovidCountryStat[]>(\r\n    API_COVID_19_ALL_COUNTRY,\r\n    { cacheKey: 'covid19-country-all', cacheMaxAge: 60 * 60 * 1000 }, // 1 hour cache\r\n  );\r\n  const {\r\n    processedData,\r\n    dataOptions: { sortKey, sortDirection },\r\n    handleColumnClick,\r\n    handleKeywordChange,\r\n  } = useTabularData(data, {\r\n    filterKey: 'country',\r\n    sortKey: 'country',\r\n    sortDirection: 'ascending',\r\n  });\r\n\r\n  const renderTable = () => {\r\n    if (loading) return <Loading />;\r\n    if (error) return <p>{error.message}</p>;\r\n    if (!data) return <p>No data!</p>;\r\n    return (\r\n      <DataTable\r\n        data={processedData}\r\n        columns={columns}\r\n        idKey=\"country\"\r\n        sortKey={sortKey}\r\n        sortDirection={sortDirection}\r\n        handleColumnClick={handleColumnClick}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <StyledCovidStatHeader>\r\n        <StyledCovidStatTitle>코로나 바이러스 세계 현황</StyledCovidStatTitle>\r\n        <Search handleChange={handleKeywordChange} />\r\n      </StyledCovidStatHeader>\r\n      <StyledCovidStatBody>\r\n        <StyledCovidStatScroll>{renderTable()}</StyledCovidStatScroll>\r\n      </StyledCovidStatBody>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CovidStatTable;\r\n","/**\r\n * API endpoint for latest worldwide COVID19 statistics.\r\n *\r\n * @docs https://covid19-api.com/docs\r\n */\r\nexport const API_COVID_19_ALL_COUNTRY = 'https://covid19-api.com/country/all';\r\n","import type { FunctionComponent } from 'react';\r\nimport React from 'react';\r\n\r\nimport CovidStatistics from './components/CovidStatistics';\r\n\r\nconst App: FunctionComponent = () => {\r\n  return <CovidStatistics />;\r\n};\r\n\r\nexport default App;\r\n","import './index.css';\r\n\r\nimport React from 'react';\r\nimport { render } from 'react-dom';\r\n\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nrender(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n\r\n  document.getElementById('root'),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n\r\nif (process.env.NODE_ENV === 'development') {\r\n  reportWebVitals(console.log);\r\n}\r\n"],"sourceRoot":""}